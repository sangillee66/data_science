<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ko" xml:lang="ko"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.24">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="이상일, 김우형">
<title>데이터 수집하기 – Data Science</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./lab_09_2025.html" rel="next">
<link href="./lab_07_2025.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dc55a5b9e770e841cd82e46aadbfb9b0.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-b651517ce65839d647a86e2780455cfb.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dc55a5b9e770e841cd82e46aadbfb9b0.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-9e227471bb36b425561843ed1c2ca3ae.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-1d1e30c4ff39a421c5d0be39657e8b6a.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-9e227471bb36b425561843ed1c2ca3ae.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "일치 없음",
    "search-matching-documents-text": "일치된 문서",
    "search-copy-link-title": "검색 링크 복사",
    "search-hide-matches-text": "추가 검색 결과 숨기기",
    "search-more-match-text": "추가 검색결과",
    "search-more-matches-text": "추가 검색결과",
    "search-clear-button-title": "제거",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "취소",
    "search-submit-button-title": "검색",
    "search-label": "검색"
  }
}</script><link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="site_libs/datatables-binding-0.33/datatables.js"></script><script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script><link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script><link rel="stylesheet" href="styles.css">
</head>
<body class="nav-sidebar floating quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="사이드바 전환" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <a class="flex-grow-1 no-decor" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="사이드바 전환" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
          <h1 class="quarto-secondary-nav-title">데이터 수집하기</h1>
        </a>     
      <button type="button" class="btn quarto-search-button" aria-label="검색" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
      <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="다크 모드 전환"><i class="bi"></i></a>
</div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="검색"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">웹사이트 소개</span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">R과 데이터사이언스</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="토글 섹션">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exec_01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R과 RStudio</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exec_02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R과 데이터사이언스 과정</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exec_03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">소통하기: Quarto로 대시보드 만들기</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exec_04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">불러오기와 정돈하기</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exec_05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">변형하기</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exec_06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">시각화하기</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exec_07.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">탐색하기</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exec_08.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">수집하기</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exec_09.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">소통하기: 인터랙티브 시각화</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exec_10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">소통하기: 지리공간적 시각화</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">R 프레젠테이션: 2025/2</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="토글 섹션">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R_lec_01_2025.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">| <span style="color:coral;font-size:0.6em">R Lecture 1</span> | <span style="font-size:1em">R과 RStudio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R_lec_02_2025.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">| <span style="color:coral;font-size:0.6em">R Lecture 2</span> | <span style="font-size:1em">R과 데이터사이언스</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R_lec_03_2025.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">| <span style="color:coral;font-size:0.6em">R Lecture 3</span> | <span style="font-size:1em">소통하기: Quarto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R_lec_04_2025.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">| <span style="color:coral;font-size:0.6em">R Lecture 4</span> | <span style="font-size:1em">데이터 불러오기와 정돈하기</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R_lec_05_2025.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">| <span style="color:coral;font-size:0.6em">R Lecture 5</span> | <span style="font-size:1em">데이터 변형하기</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R_lec_06_2025.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">| <span style="color:coral;font-size:0.6em">R Lecture 6</span> | <span style="font-size:1em">데이터 시각화하기</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R_lec_07_2025.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">| <span style="color:coral;font-size:0.6em">R Lecture 7</span> | <span style="font-size:1em">데이터 탐색하기</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R_lec_08_2025.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">| <span style="color:coral;font-size:0.6em">R Lecture 8</span> | <span style="font-size:1em">데이터 수집하기</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R_lec_09_2025.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">| <span style="color:coral;font-size:0.6em">R Lecture 9</span> | <span style="font-size:1em">웹 앱 개발: 인터랙티브 시각화</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">R 프레젠테이션: 2024/1</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="토글 섹션">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R_lec_01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R &amp; RStudio</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R_lec_02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R &amp; Data Science</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R_lec_03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Import and Tidying</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R_lec_04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Transformation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R_lec_05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Visualization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R_lec_06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Exploration</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R_lec_07.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Collection</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R_lec_08.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Communication with Data: Quarto</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R_lec_09.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Communication with Data: Dashboards</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R_lec_10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Advanced R</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">R 실습: 2025/2</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="토글 섹션">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_01_2025.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R and RStudio</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_02_2025.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R과 데이터사이언스 과정</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_03_2025.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">소통하기: Quarto로 대시보드 만들기</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_04_2025.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">데이터 불러오기와 정돈하기</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_05_2025.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">데이터 변형하기</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_06_2025.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">시각화하기</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_07_2025.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">데이터 사이언스의 과정 복습하기</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_08_2025.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Lab07: 데이터 수집하기</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_09_2025.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">소통하기: 인터랙티브 시각화</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">R 실습: 2024/1</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="토글 섹션">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab01: R과 RStudio</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab02: R과 데이터사이언스</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab03: 데이터 불러오기와 정리하기</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab04: 데이터 변형하기</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab05: 데이터 시각화하기</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab06: 데이터 탐색하기</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_07.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab07: 데이터 수집하기</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_08.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab08: 데이터로 소통하기: Quarto</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_09.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab09: 데이터로 소통하기: 대시보드 만들기</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab10: 데이터로 소통하기: 동적, 반응형 시각화</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">목차</h2>
   
  <ul>
<li><a href="#%EC%8B%A4%EC%8A%B5-%EA%B0%9C%EC%9A%94" id="toc-실습-개요" class="nav-link active" data-scroll-target="#%EC%8B%A4%EC%8A%B5-%EA%B0%9C%EC%9A%94">실습 개요</a></li>
  <li><a href="#%EC%9B%B9%EC%83%81%EC%9D%98-%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%8C%8C%EC%9D%BC-%EB%B6%88%EB%9F%AC%EC%98%A4%EA%B8%B0" id="toc-웹상의-데이터-파일-불러오기" class="nav-link" data-scroll-target="#%EC%9B%B9%EC%83%81%EC%9D%98-%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%8C%8C%EC%9D%BC-%EB%B6%88%EB%9F%AC%EC%98%A4%EA%B8%B0"><span class="header-section-number">1</span> 웹상의 데이터 파일 불러오기</a></li>
  <li>
<a href="#%EC%9B%B9%EC%8A%A4%ED%81%AC%EB%A0%88%EC%9D%B4%ED%95%91" id="toc-웹스크레이핑" class="nav-link" data-scroll-target="#%EC%9B%B9%EC%8A%A4%ED%81%AC%EB%A0%88%EC%9D%B4%ED%95%91"><span class="header-section-number">2</span> 웹스크레이핑</a>
  <ul class="collapse">
<li><a href="#%EC%9B%B9%EC%8A%A4%ED%81%AC%EB%A0%88%EC%9D%B4%ED%95%91%EC%9D%98-%EC%8B%A4%EC%A0%9C-1-%ED%85%8C%EC%9D%B4%EB%B8%94%EC%9D%B4-%ED%95%98%EB%82%98-%EC%9E%88%EB%8A%94-%EA%B2%BD%EC%9A%B0" id="toc-웹스크레이핑의-실제-1-테이블이-하나-있는-경우" class="nav-link" data-scroll-target="#%EC%9B%B9%EC%8A%A4%ED%81%AC%EB%A0%88%EC%9D%B4%ED%95%91%EC%9D%98-%EC%8B%A4%EC%A0%9C-1-%ED%85%8C%EC%9D%B4%EB%B8%94%EC%9D%B4-%ED%95%98%EB%82%98-%EC%9E%88%EB%8A%94-%EA%B2%BD%EC%9A%B0"><span class="header-section-number">2.1</span> 웹스크레이핑의 실제 1: 테이블이 하나 있는 경우</a></li>
  <li><a href="#%EC%9B%B9%EC%8A%A4%ED%81%AC%EB%A0%88%EC%9D%B4%ED%95%91%EC%9D%98-%EC%8B%A4%EC%A0%9C-2-%ED%85%8C%EC%9D%B4%EB%B8%94%EC%9D%B4-%EB%91%98-%EC%9D%B4%EC%83%81%EC%9D%B8-%EA%B2%BD%EC%9A%B0" id="toc-웹스크레이핑의-실제-2-테이블이-둘-이상인-경우" class="nav-link" data-scroll-target="#%EC%9B%B9%EC%8A%A4%ED%81%AC%EB%A0%88%EC%9D%B4%ED%95%91%EC%9D%98-%EC%8B%A4%EC%A0%9C-2-%ED%85%8C%EC%9D%B4%EB%B8%94%EC%9D%B4-%EB%91%98-%EC%9D%B4%EC%83%81%EC%9D%B8-%EA%B2%BD%EC%9A%B0"><span class="header-section-number">2.2</span> 웹스크레이핑의 실제 2: 테이블이 둘 이상인 경우</a></li>
  </ul>
</li>
  <li>
<a href="#api%EC%9D%98-%ED%99%9C%EC%9A%A9" id="toc-api의-활용" class="nav-link" data-scroll-target="#api%EC%9D%98-%ED%99%9C%EC%9A%A9"><span class="header-section-number">3</span> API의 활용</a>
  <ul class="collapse">
<li><a href="#kosis%EC%97%90%EC%84%9C-api-key-%EB%B0%9B%EA%B8%B0" id="toc-kosis에서-api-key-받기" class="nav-link" data-scroll-target="#kosis%EC%97%90%EC%84%9C-api-key-%EB%B0%9B%EA%B8%B0"><span class="header-section-number">3.1</span> KOSIS에서 API KEY 받기</a></li>
  <li><a href="#%ED%8C%A8%ED%82%A4%EC%A7%80-%EC%84%A4%EC%B9%98-%EB%B0%8F-%EC%9D%B8%EC%A6%9D%ED%82%A4-%EB%93%B1%EB%A1%9D" id="toc-패키지-설치-및-인증키-등록" class="nav-link" data-scroll-target="#%ED%8C%A8%ED%82%A4%EC%A7%80-%EC%84%A4%EC%B9%98-%EB%B0%8F-%EC%9D%B8%EC%A6%9D%ED%82%A4-%EB%93%B1%EB%A1%9D"><span class="header-section-number">3.2</span> 패키지 설치 및 인증키 등록</a></li>
  <li><a href="#%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%B6%94%EC%B6%9C" id="toc-데이터-추출" class="nav-link" data-scroll-target="#%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%B6%94%EC%B6%9C"><span class="header-section-number">3.3</span> 데이터 추출</a></li>
  <li><a href="#%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%A0%95%EB%A6%AC-%EB%B0%8F-%EB%B3%80%ED%98%95" id="toc-데이터-정리-및-변형" class="nav-link" data-scroll-target="#%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%A0%95%EB%A6%AC-%EB%B0%8F-%EB%B3%80%ED%98%95"><span class="header-section-number">3.4</span> 데이터 정리 및 변형</a></li>
  <li><a href="#%EA%B7%B8%EB%9E%98%ED%94%84-%EC%9E%91%EC%84%B1" id="toc-그래프-작성" class="nav-link" data-scroll-target="#%EA%B7%B8%EB%9E%98%ED%94%84-%EC%9E%91%EC%84%B1"><span class="header-section-number">3.5</span> 그래프 작성</a></li>
  <li><a href="#cf-kosis-api%EB%A5%BC-%ED%99%9C%EC%9A%A9%ED%95%9C-%ED%95%A8%EC%88%98-%EC%9E%91%EC%84%B1" id="toc-cf-kosis-api를-활용한-함수-작성" class="nav-link" data-scroll-target="#cf-kosis-api%EB%A5%BC-%ED%99%9C%EC%9A%A9%ED%95%9C-%ED%95%A8%EC%88%98-%EC%9E%91%EC%84%B1"><span class="header-section-number">3.6</span> cf) KOSIS API를 활용한 함수 작성</a></li>
  </ul>
</li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/sangillee66/data_science/issues/new" class="toc-action"><i class="bi bi-github"></i>이슈 보고</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title d-none d-lg-block">데이터 수집하기</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">저자</div>
    <div class="quarto-title-meta-contents">
             <p>이상일, 김우형 </p>
          </div>
  </div>
    
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">2025년 11월 10일</p>
    </div>
  </div>
    
  </div>
  


</header><section id="실습-개요" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="실습-개요">실습 개요</h2>
<p>이 실습은 R로 데이터를 수집하는 과정을 다룬다. R을 활용한 데이터 수집은 다양한 방법으로 진행될 수 있지만 여기서는 웹상의 데이터 파일 불러오기, 웹 스크레이핑, API를 이용하는 방식에 집중한다. 실습의 시작은&nbsp;<a href="https://www.tidyverse.org/"><code>tidyverse</code></a>&nbsp;패키지를 불러오는 것이다.</p>
</section><section id="웹상의-데이터-파일-불러오기" class="level2" data-number="1"><h2 data-number="1" class="anchored" data-anchor-id="웹상의-데이터-파일-불러오기">
<span class="header-section-number">1</span> 웹상의 데이터 파일 불러오기</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span></code></pre></div><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>아마도 데이터를 수집하는 가장 단순한 방법은 웹상에 파일 형태로 존재하는 데이터를 R에서 불러오는 것일 것이다.&nbsp;<code>readr</code>&nbsp;패키지에서 제공하는 다양한 데이터 불러오기 함수(예:&nbsp;<a href="https://readr.tidyverse.org/reference/read_delim.html"><code>read_csv()</code></a>)를 데이터의 URL에 적용하면 손쉽게 데이터를 획득할 수 있다.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">students</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"https://pos.it/r4ds-students-csv"</span><span class="op">)</span></span>
<span><span class="va">students</span></span></code></pre></div><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  `Student ID` `Full Name`      favourite.food     mealPlan            AGE  
         &lt;dbl&gt; &lt;chr&gt;            &lt;chr&gt;              &lt;chr&gt;               &lt;chr&gt;
1            1 Sunil Huffmann   Strawberry yoghurt Lunch only          4    
2            2 Barclay Lynn     French fries       Lunch only          5    
3            3 Jayendra Lyne    N/A                Breakfast and lunch 7    
4            4 Leon Rossini     Anchovies          Lunch only          &lt;NA&gt; 
5            5 Chidiegwu Dunkel Pizza              Breakfast and lunch five 
6            6 Güvenç Attila    Ice cream          Lunch only          6    </code></pre>
</div>
</div>
<p>그런데 엑셀 형식의 파일은&nbsp;<a href="https://readxl.tidyverse.org/"><code>readxl</code></a>&nbsp;패키지가 제공하는&nbsp;<a href="https://readxl.tidyverse.org/reference/read_excel.html"><code>read_excel()</code></a>&nbsp;함수를 이용해 막바로 데이터를 불러오는 것이 불가능하다. <a href="https://ycphs.github.io/openxlsx/"><code>openxlsx</code></a>&nbsp;패키지는 이러한 문제를 해결할 수 있게 해준다. 정말 다양한 함수를 제공하지만&nbsp;<a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html"><code>read.xlsx()</code></a>&nbsp;함수가 URL을 통해 엑셀 데이터를 불러오는데 사용된다.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ycphs.github.io/openxlsx/index.html">openxlsx</a></span><span class="op">)</span></span>
<span><span class="va">xlsx_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html">read.xlsx</a></span><span class="op">(</span><span class="st">"https://github.com/awalker89/openxlsx/raw/master/inst/readTest.xlsx"</span><span class="op">)</span></span>
<span><span class="va">xlsx_data</span></span></code></pre></div><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Var1 Var2   Var3 Var4  Var5         Var6 Var7
1   TRUE    1   1.00    a 42042 3209324 This   NA
2   TRUE   NA     NA    b 42041         &lt;NA&gt;   NA
3   TRUE    2   1.34    c 42040         &lt;NA&gt;   NA
4  FALSE    2     NA &lt;NA&gt;    NA         &lt;NA&gt;   NA
5  FALSE    3   1.56    e    NA         &lt;NA&gt;   NA
6  FALSE    1   1.70    f 42037         &lt;NA&gt;   NA
7     NA   NA     NA &lt;NA&gt; 42036         &lt;NA&gt;   NA
8  FALSE    2  23.00    h 42035         &lt;NA&gt;   NA
9  FALSE    3  67.30    i 42034         &lt;NA&gt;   NA
10    NA    1 123.00 &lt;NA&gt; 42033         &lt;NA&gt;   NA</code></pre>
</div>
</div>
</section><section id="웹스크레이핑" class="level2" data-number="2"><h2 data-number="2" class="anchored" data-anchor-id="웹스크레이핑">
<span class="header-section-number">2</span> 웹스크레이핑</h2>
<p>웹스크레이핑(web scraping)이란 웹페이지로부터 특정한 데이터를 추출하는 것을 의미한다. R에서 웹스크레이핑은 <code>rvest</code> 패키지가 담당하는데, <code>reaxl</code> 패키지와 마찬가지로 <code>tidyverse</code>의 핵심 패키지는 아니기 때문에 따로 불러와야 한다.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rvest.tidyverse.org/">rvest</a></span><span class="op">)</span></span></code></pre></div><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="웹스크레이핑의-실제-1-테이블이-하나-있는-경우" class="level3" data-number="2.1"><h3 data-number="2.1" class="anchored" data-anchor-id="웹스크레이핑의-실제-1-테이블이-하나-있는-경우">
<span class="header-section-number">2.1</span> 웹스크레이핑의 실제 1: 테이블이 하나 있는 경우</h3>
<p>위키피디어의 한 항목(List of countries and dependencies by population)에는 표 하나가 포함되어 있다. 해당 표의 데이터를 수집한다.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">url</span> <span class="op">&lt;-</span> <span class="st">"https://en.wikipedia.org/wiki/List_of_countries_and_dependencies_by_population"</span></span>
<span><span class="va">my_table</span> <span class="op">&lt;-</span> <span class="va">url</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="http://xml2.r-lib.org/reference/read_xml.html">read_html</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_element.html">html_element</a></span><span class="op">(</span><span class="st">"table"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_table.html">html_table</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">my_table</span></span></code></pre></div><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 240 × 6
   Location      Population    `% ofworld` Date     Source (official or …¹ Notes
   &lt;chr&gt;         &lt;chr&gt;         &lt;chr&gt;       &lt;chr&gt;    &lt;chr&gt;                  &lt;chr&gt;
 1 World         8,232,000,000 100%        13 Jun … UN projection[1][3]    ""   
 2 India         1,417,492,000 17.3%       1 Jul 2… Official projection[4] "[b]"
 3 China         1,408,280,000 17.2%       31 Dec … Official estimate[5]   "[c]"
 4 United States 340,110,988   4.1%        1 Jul 2… Official estimate[6]   "[d]"
 5 Indonesia     284,438,782   3.5%        30 Jun … National annual proje… ""   
 6 Pakistan      241,499,431   2.9%        1 Mar 2… 2023 census result[8]  "[e]"
 7 Nigeria       223,800,000   2.7%        1 Jul 2… Official projection[9] ""   
 8 Brazil        213,421,037   2.6%        1 Jul 2… Official estimate[10]  ""   
 9 Bangladesh    169,828,911   2.1%        14 Jun … 2022 census result[11] "[f]"
10 Russia        146,028,325   1.8%        1 Jan 2… Official estimate[13]  "[g]"
# ℹ 230 more rows
# ℹ abbreviated name: ¹​`Source (official or fromthe United Nations)`</code></pre>
</div>
</div>
<p>수집한 데이터를 가공해본다. 필요없는 컬럼을 제거하고, 컬럼 이름을 바꾸고, 몇몇 변수를 특정 형태의 타입(numeric, date)으로 변환하기 위한 과정이다.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">my_table</span> <span class="op">&lt;-</span> <span class="va">my_table</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span></span>
<span>    location <span class="op">=</span> <span class="st">"Location"</span>,</span>
<span>    population <span class="op">=</span> <span class="st">"Population"</span>,</span>
<span>    pop_pct <span class="op">=</span> <span class="st">"% ofworld"</span>,</span>
<span>    date <span class="op">=</span> <span class="st">"Date"</span>,</span>
<span>    source <span class="op">=</span> <span class="st">"Source (official or fromthe United Nations)"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    population <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove_all</a></span><span class="op">(</span><span class="va">population</span>, <span class="st">","</span><span class="op">)</span>,</span>
<span>    population <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">population</span><span class="op">)</span>,</span>
<span>    pop_pct <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span><span class="op">(</span><span class="va">pop_pct</span>, <span class="st">"%"</span><span class="op">)</span>,</span>
<span>    pop_pct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">pop_pct</span><span class="op">)</span>,</span>
<span>    date <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">dmy</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">my_table</span></span></code></pre></div><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 240 × 5
   location      population pop_pct date       source                       
   &lt;chr&gt;              &lt;dbl&gt;   &lt;dbl&gt; &lt;date&gt;     &lt;chr&gt;                        
 1 World         8232000000   100   2025-06-13 UN projection[1][3]          
 2 India         1417492000    17.3 2025-07-01 Official projection[4]       
 3 China         1408280000    17.2 2024-12-31 Official estimate[5]         
 4 United States  340110988     4.1 2024-07-01 Official estimate[6]         
 5 Indonesia      284438782     3.5 2025-06-30 National annual projection[7]
 6 Pakistan       241499431     2.9 2023-03-01 2023 census result[8]        
 7 Nigeria        223800000     2.7 2023-07-01 Official projection[9]       
 8 Brazil         213421037     2.6 2025-07-01 Official estimate[10]        
 9 Bangladesh     169828911     2.1 2022-06-14 2022 census result[11]       
10 Russia         146028325     1.8 2025-01-01 Official estimate[13]        
# ℹ 230 more rows</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="유용한 문자열 함수">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">노트</span>유용한 문자열 함수
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>코드에 포함된 <code><a href="https://readr.tidyverse.org/reference/parse_number.html">parse_number()</a></code>과 <code><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove_all()</a></code> 함수는 매우 유용한 함수이므로 잘 익혀 둘 필요가 있다. <code><a href="https://readr.tidyverse.org/reference/parse_number.html">parse_number()</a></code>함수는 <a href="https://readr.tidyverse.org/"><strong>readr</strong></a> 패키지에 포함되어 있는 것으로, 투입 벡터에서 오로지 숫자만 골라내 실수형 벡터를 생성해준다. 위의 예를 보자면, <code>my_table</code> 데이터 프레임의 <code>population</code> 컬럼은 인구수와 콤마가 결합된 문자형 벡터이므로 콤마를 제거하고 숫자만 추출할 필요가 있다. 유사한 함수에 <code><a href="https://readr.tidyverse.org/reference/parse_atomic.html">parse_logical()</a></code>, <code><a href="https://readr.tidyverse.org/reference/parse_atomic.html">parse_integer()</a></code>, <code><a href="https://readr.tidyverse.org/reference/parse_atomic.html">parse_double()</a></code>, <code><a href="https://readr.tidyverse.org/reference/parse_atomic.html">parse_character()</a></code>, <code><a href="https://readr.tidyverse.org/reference/parse_factor.html">parse_factor()</a></code> 등이 있다. <code><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove_all()</a></code> 함수는 <a href="https://www.tidyverse.org/"><strong>tidyverse</strong></a>의 핵심 패키지 중의 하나인 <a href="https://stringr.tidyverse.org/"><strong>stringr</strong></a> 패키지에 포함되어 있는 것으로, 투입 벡터에서 특정한 문자나 문자 패턴을 제거해 준다. 위의 예를 보자면, <code>my_table</code> 데이터 프레임의 <code>pop_pct</code> 컬럼에는 %라는 부호가 포함되어 있기 때문에 그것을 제거할 필요가 있다. 그러므로 <code><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove_all()</a></code> 함수는 셀에 포함되어 있는 특정 문자 모두를 제거할 때 사용할 수 있는 함수이다. 유사한 함수에 <code><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove()</a></code>도 있는데, 이것은 셀에 포함되어 있는 특정 문자 중 단지 첫 번째 것만 제거한다. 문자열을 잘 다루려면 정규표현식(regular expression)에 대한 상당한 이해가 있어야 한다. 다음의 링크가 도움이 될 수 있을 것이다. <a href="https://bookdown.org/ahn_media/bookdown-demo/cleantool.html#%EC%A0%95%EA%B7%9C%ED%91%9C%ED%98%84%EC%8B%9Dregular-expressions" class="uri">https://bookdown.org/ahn_media/bookdown-demo/cleantool.html#%EC%A0%95%EA%B7%9C%ED%91%9C%ED%98%84%EC%8B%9Dregular-expressions</a></p>
</div>
</div>
</div>
</section><section id="웹스크레이핑의-실제-2-테이블이-둘-이상인-경우" class="level3" data-number="2.2"><h3 data-number="2.2" class="anchored" data-anchor-id="웹스크레이핑의-실제-2-테이블이-둘-이상인-경우">
<span class="header-section-number">2.2</span> 웹스크레이핑의 실제 2: 테이블이 둘 이상인 경우</h3>
<p>위키피디아의 한 항목(List of FIPS country codes)에는 동일한 내용에 대해 여러 개의 표가 나타나 있다. 개별 표의 데이터를 수집한 후 결합하여 단일한 데이터 프레임을 구성한다.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">url</span> <span class="op">&lt;-</span> <span class="st">"https://en.wikipedia.org/wiki/List_of_FIPS_country_codes"</span></span>
<span><span class="va">my_tables</span> <span class="op">&lt;-</span> <span class="va">url</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="http://xml2.r-lib.org/reference/read_xml.html">read_html</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_element.html">html_elements</a></span><span class="op">(</span><span class="st">"table"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># 'element'가 아니라 'elements'이다.</span></span>
<span>  <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_table.html">html_table</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html">bind_rows</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">my_tables</span></span></code></pre></div><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 277 × 10
   Code    `Short-form name` .mw-parser-output .n…¹ .mw-parser-output .n…² ...3 
   &lt;chr&gt;   &lt;chr&gt;             &lt;chr&gt;                  &lt;chr&gt;                  &lt;chr&gt;
 1 .mw-pa… Aruba             &lt;NA&gt;                   &lt;NA&gt;                   &lt;NA&gt; 
 2 AC      Antigua and Barb… &lt;NA&gt;                   &lt;NA&gt;                   &lt;NA&gt; 
 3 AD      Akrotiri          &lt;NA&gt;                   &lt;NA&gt;                   &lt;NA&gt; 
 4 AE      United Arab Emir… &lt;NA&gt;                   &lt;NA&gt;                   &lt;NA&gt; 
 5 AF      Afghanistan       &lt;NA&gt;                   &lt;NA&gt;                   &lt;NA&gt; 
 6 AG      Algeria           &lt;NA&gt;                   &lt;NA&gt;                   &lt;NA&gt; 
 7 AJ      Azerbaijan        &lt;NA&gt;                   &lt;NA&gt;                   &lt;NA&gt; 
 8 AL      Albania           &lt;NA&gt;                   &lt;NA&gt;                   &lt;NA&gt; 
 9 AM      Armenia           &lt;NA&gt;                   &lt;NA&gt;                   &lt;NA&gt; 
10 AN      Andorra           &lt;NA&gt;                   &lt;NA&gt;                   &lt;NA&gt; 
# ℹ 267 more rows
# ℹ abbreviated names:
#   ¹​`.mw-parser-output .navbar{display:inline;font-size:88%;font-weight:normal}.mw-parser-output .navbar-collapse{float:left;text-align:left}.mw-parser-output .navbar-boxtext{word-spacing:0}.mw-parser-output .navbar ul{display:inline-block;white-space:nowrap;line-height:inherit}.mw-parser-output .navbar-brackets::before{margin-right:-0.125em;content:"[ "}.mw-parser-output .navbar-brackets::after{margin-left:-0.125em;content:" ]"}.mw-parser-output .navbar li{word-spacing:-0.125em}.mw-parser-output .navbar a&gt;span,.mw-parser-output .navbar a&gt;abbr{text-decoration:inherit}.mw-parser-output .navbar-mini abbr{font-variant:small-caps;border-bottom:none;text-decoration:none;cursor:inherit}.mw-parser-output .navbar-ct-full{font-size:114%;margin:0 7em}.mw-parser-output .navbar-ct-mini{font-size:114%;margin:0 4em}html.skin-theme-clientpref-night .mw-parser-output .navbar li a abbr{color:var(--color-base)!important}@media(prefers-color-scheme:dark){html.skin-theme-clientpref-os .mw-parser-output .navbar li a abbr{color:var(--color-base)!important}}@media print{.mw-parser-output .navbar{display:none!important}}vteGeocode systems...1`,
#   ²​`.mw-parser-output .navbar{display:inline;font-size:88%;font-weight:normal}.mw-parser-output .navbar-collapse{float:left;text-align:left}.mw-parser-output .navbar-boxtext{word-spacing:0}.mw-parser-output .navbar ul{display:inline-block;white-space:nowrap;line-height:inherit}.mw-parser-output .navbar-brackets::before{margin-right:-0.125em;content:"[ "}.mw-parser-output .navbar-brackets::after{margin-left:-0.125em;content:" ]"}.mw-parser-output .navbar li{word-spacing:-0.125em}.mw-parser-output .navbar a&gt;span,.mw-parser-output .navbar a&gt;abbr{text-decoration:inherit}.mw-parser-output .navbar-mini abbr{font-variant:small-caps;border-bottom:none;text-decoration:none;cursor:inherit}.mw-parser-output .navbar-ct-full{font-size:114%;margin:0 7em}.mw-parser-output .navbar-ct-mini{font-size:114%;margin:0 4em}html.skin-theme-clientpref-night .mw-parser-output .navbar li a abbr{color:var(--color-base)!important}@media(prefers-color-scheme:dark){html.skin-theme-clientpref-os .mw-parser-output .navbar li a abbr{color:var(--color-base)!important}}@media print{.mw-parser-output .navbar{display:none!important}}vteGeocode systems...2`
# ℹ 5 more variables: ...4 &lt;chr&gt;, ...5 &lt;chr&gt;, ...6 &lt;chr&gt;, X1 &lt;chr&gt;, X2 &lt;chr&gt;</code></pre>
</div>
</div>
<p>수집한 데이터를 약간 가공한다. 역시 필요한 컬럼만 남기고, 이름을 바꿔준다. 마지막 <code>str_extract</code>는 Aruba의 단축어에 원치 않는 문자열이 추가되어 있어 제거하기 위한 코드이다.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">my_tables</span> <span class="op">&lt;-</span> <span class="va">my_tables</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span></span>
<span>    code <span class="op">=</span> <span class="st">"Code"</span>, </span>
<span>    short_name <span class="op">=</span> <span class="st">"Short-form name"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    code <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_extract.html">str_extract</a></span><span class="op">(</span><span class="va">code</span>, <span class="st">"[A-Z][A-Z]"</span><span class="op">)</span> <span class="co"># 알파벳 두 개가 연결되어 있는 것을 추출</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">my_tables</span></span></code></pre></div><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 277 × 2
   code  short_name          
   &lt;chr&gt; &lt;chr&gt;               
 1 AA    Aruba               
 2 AC    Antigua and Barbuda 
 3 AD    Akrotiri            
 4 AE    United Arab Emirates
 5 AF    Afghanistan         
 6 AG    Algeria             
 7 AJ    Azerbaijan          
 8 AL    Albania             
 9 AM    Armenia             
10 AN    Andorra             
# ℹ 267 more rows</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">힌트</span>추가 예제
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>간혹 테이블을 불러올 때 데이터가 깨지는 경우도 발생한다. 이는 인코딩 방식의 문제인데, 아래와 같이 인코딩 아규먼트를 추가하면 해결된다. 보통 “EUC-KR”이나 “UTF-8” 둘 중 하나는 제대로 작동한다.</p>
<p>한 번 네이버가 제공하는 주식 거래 상위 품목을 크롤링해보자.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/DT">DT</a></span><span class="op">)</span></span>
<span><span class="va">kospi</span> <span class="op">&lt;-</span> <span class="st">"https://finance.naver.com/sise/sise_quant.naver?sosok=0"</span></span>
<span></span>
<span><span class="va">kospi_table</span> <span class="op">&lt;-</span> <span class="va">kospi</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="http://xml2.r-lib.org/reference/read_xml.html">read_html</a></span><span class="op">(</span>, encoding <span class="op">=</span> <span class="st">"EUC-KR"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_element.html">html_elements</a></span><span class="op">(</span><span class="st">"table"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rvest.tidyverse.org/reference/html_table.html">html_table</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="va">_</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span> <span class="op">==</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html">datatable</a></span><span class="op">(</span><span class="va">kospi_table</span><span class="op">)</span></span></code></pre></div><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-f506e57621df1859adf8" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-f506e57621df1859adf8">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100"],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],["KODEX 200선물인버스2X","KODEX 인버스","KODEX 2차전지산업레버리지","KODEX 레버리지","삼성전자","KODEX 코스닥150레버리지","TIGER 200선물인버스2X","KODEX 코스닥150선물인버스","코오롱모빌리티그룹","상상인증권","KODEX 200","TIGER 화장품","동양","KODEX 코스닥150","카카오","미래에셋증권","삼성 인버스 2X 코스닥150 선물 ETN","삼성 인버스 2X 코스피200 선물 ETN","한국전력","대한전선","TIGER 반도체TOP10","삼영","TIGER 미국S&amp;P500","TIGER 2차전지소재Fn","금호타이어","TIGER 2차전지TOP10레버리지","SK하이닉스","두산에너빌리티","대원전선","PLUS 고배당주","ACE KRX금현물","KODEX 200타겟위클리커버드콜","SK증권","삼성중공업","KODEX AI전력핵심설비","대덕전자","TIGER 코리아AI전력기기TOP3플러스","KODEX 은행","형지엘리트","KODEX 미국S&amp;P500","HJ중공업","KODEX AI반도체","KODEX 2차전지산업","우리금융지주","KODEX 금융고배당TOP10타겟위클리커버드콜","TIGER 200","삼성 인버스 2X WTI원유 선물 ETN","KODEX 반도체레버리지","KODEX 증권","ACE 테슬라밸류체인액티브","DB하이텍","한온시스템","TIGER 은행고배당플러스TOP10","에이프로젠","TIGER TOP10","서울식품","TIGER 차이나휴머노이드로봇","SOL 금융지주플러스고배당","TIGER 리츠부동산인프라","유진투자증권","한화투자증권","TIGER 2차전지TOP10","디아이씨","TIGER 지주회사","삼성전자우","TIGER 미국30년국채커버드콜액티브(H)","SOL 조선TOP3플러스","YG PLUS","신한 인버스 2X WTI원유 선물 ETN(H)","ACE 미국30년국채액티브(H)","TIGER 차이나전기차SOLACTIVE","미래에셋 인버스 2X 코스피200 선물 ETN","TIGER 미국테크TOP10 INDXX","일동제약","대한해운","신한지주","이수페타시스","KODEX 반도체","NH투자증권","KODEX 미국나스닥100","TIGER KRX금현물","KODEX 미국AI전력핵심인프라","HANARO Fn K-반도체","삼성제약","파미셀","KODEX 2차전지핵심소재10","TIMEFOLIO K바이오액티브","TIGER 미국AI전력SMR","한화오션","후성","TIGER 조선TOP10","DYP","한국타이어앤테크놀로지","KB금융","TIGER 200 중공업","TIGER 차이나항셍테크","KODEX 미국30년국채타겟커버드콜(합성 H)","ACE AI반도체포커스","TIGER 코리아배당다우존스","삼성 레버리지 천연가스 선물 ETN C"],["706","2,590","1,779","43,600","100,600","11,410","748","2,985","13,130","724","57,655","3,510","877","15,320","62,300","23,900","3,695","4,015","46,250","24,950","18,825","5,650","24,410","5,620","5,400","1,656","606,000","79,600","4,040","21,070","27,500","13,620","698","27,050","25,775","47,300","13,620","12,725","1,354","22,355","22,000","17,040","15,935","26,200","12,750","57,675","86","27,865","15,845","21,940","61,800","4,405","21,260","640","19,590","150","12,770","17,495","4,380","3,790","5,320","10,020","6,050","16,725","77,100","7,885","35,915","6,320","70","7,820","13,150","4,015","31,000","27,050","1,850","78,800","117,100","58,820","21,950","24,485","13,130","19,050","19,320","1,467","18,040","5,685","16,480","9,465","129,600","8,810","28,120","3,060","58,500","129,000","14,640","9,490","8,535","25,600","13,275","3,495"],["하락\n\t\t\t\t46","하락\n\t\t\t\t80","상승\n\t\t\t\t90","상승\n\t\t\t\t2,540","상승\n\t\t\t\t2,700","상승\n\t\t\t\t185","하락\n\t\t\t\t49","하락\n\t\t\t\t25","상한가\n\t\t\t\t3,030","상승\n\t\t\t\t61","상승\n\t\t\t\t1,710","하락\n\t\t\t\t20","상승\n\t\t\t\t28","상승\n\t\t\t\t135","하락\n\t\t\t\t500","상승\n\t\t\t\t800","하락\n\t\t\t\t55","하락\n\t\t\t\t275","상승\n\t\t\t\t2,150","상승\n\t\t\t\t200","상승\n\t\t\t\t775","상승\n\t\t\t\t1,020","상승\n\t\t\t\t55","상승\n\t\t\t\t140","상승\n\t\t\t\t390","상승\n\t\t\t\t87","상승\n\t\t\t\t26,000","상승\n\t\t\t\t1,700","상승\n\t\t\t\t55","상승\n\t\t\t\t810","상승\n\t\t\t\t135","상승\n\t\t\t\t420","상승\n\t\t\t\t49","상승\n\t\t\t\t750","상승\n\t\t\t\t1,110","상승\n\t\t\t\t5,050","상승\n\t\t\t\t580","상승\n\t\t\t\t385","상승\n\t\t\t\t149","상승\n\t\t\t\t45","하락\n\t\t\t\t450","상승\n\t\t\t\t740","상승\n\t\t\t\t395","상승\n\t\t\t\t500","상승\n\t\t\t\t460","상승\n\t\t\t\t1,725","하락\n\t\t\t\t2","상승\n\t\t\t\t1,195","상승\n\t\t\t\t960","하락\n\t\t\t\t455","상승\n\t\t\t\t8,400","상승\n\t\t\t\t130","상승\n\t\t\t\t650","상승\n\t\t\t\t20","상승\n\t\t\t\t555","보합0","하락\n\t\t\t\t330","상승\n\t\t\t\t660","상승\n\t\t\t\t20","상승\n\t\t\t\t300","상승\n\t\t\t\t300","상승\n\t\t\t\t235","하락\n\t\t\t\t440","상승\n\t\t\t\t845","상승\n\t\t\t\t1,800","하락\n\t\t\t\t45","상승\n\t\t\t\t905","하락\n\t\t\t\t220","하락\n\t\t\t\t1","하락\n\t\t\t\t55","하락\n\t\t\t\t135","하락\n\t\t\t\t255","상승\n\t\t\t\t150","하락\n\t\t\t\t1,050","상승\n\t\t\t\t65","상승\n\t\t\t\t1,400","상승\n\t\t\t\t13,100","상승\n\t\t\t\t1,470","상승\n\t\t\t\t2,020","상승\n\t\t\t\t55","상승\n\t\t\t\t80","상승\n\t\t\t\t645","상승\n\t\t\t\t630","하락\n\t\t\t\t83","상승\n\t\t\t\t740","상승\n\t\t\t\t110","상승\n\t\t\t\t10","상승\n\t\t\t\t380","상승\n\t\t\t\t2,800","하락\n\t\t\t\t210","상승\n\t\t\t\t700","하락\n\t\t\t\t110","상승\n\t\t\t\t9,150","상승\n\t\t\t\t5,300","상승\n\t\t\t\t470","상승\n\t\t\t\t55","하락\n\t\t\t\t60","상승\n\t\t\t\t880","상승\n\t\t\t\t665","상승\n\t\t\t\t130"],["-6.12%","-3.00%","+5.33%","+6.19%","+2.76%","+1.65%","-6.15%","-0.83%","+30.00%","+9.20%","+3.06%","-0.57%","+3.30%","+0.89%","-0.80%","+3.46%","-1.47%","-6.41%","+4.88%","+0.81%","+4.29%","+22.03%","+0.23%","+2.55%","+7.78%","+5.54%","+4.48%","+2.18%","+1.38%","+4.00%","+0.49%","+3.18%","+7.55%","+2.85%","+4.50%","+11.95%","+4.45%","+3.12%","+12.37%","+0.20%","-2.00%","+4.54%","+2.54%","+1.95%","+3.74%","+3.08%","-2.27%","+4.48%","+6.45%","-2.03%","+15.73%","+3.04%","+3.15%","+3.23%","+2.92%","0.00%","-2.52%","+3.92%","+0.46%","+8.60%","+5.98%","+2.40%","-6.78%","+5.32%","+2.39%","-0.57%","+2.58%","-3.36%","-1.41%","-0.70%","-1.02%","-5.97%","+0.49%","-3.74%","+3.64%","+1.81%","+12.60%","+2.56%","+10.14%","+0.23%","+0.61%","+3.50%","+3.37%","-5.35%","+4.28%","+1.97%","+0.06%","+4.18%","+2.21%","-2.33%","+2.55%","-3.47%","+18.54%","+4.28%","+3.32%","+0.58%","-0.70%","+3.56%","+5.27%","+3.86%"],["1,219,670,272","81,646,319","39,148,463","25,466,939","23,415,247","21,632,700","16,711,648","16,117,669","11,729,586","9,483,104","9,446,204","8,832,425","8,727,722","8,380,419","7,961,192","6,747,189","6,713,376","6,484,708","6,243,476","5,903,918","5,604,801","5,350,245","5,125,226","5,055,441","5,034,112","4,888,096","4,868,645","4,562,734","4,554,870","4,545,593","4,525,375","4,487,791","4,203,471","4,105,719","4,072,378","4,054,350","3,991,253","3,965,168","3,952,154","3,606,149","3,585,053","3,553,402","3,375,551","3,344,013","3,317,152","3,301,336","3,292,687","3,281,820","3,279,252","3,199,770","3,144,244","3,007,163","2,814,198","2,774,538","2,618,592","2,599,741","2,560,352","2,531,882","2,512,365","2,493,203","2,448,599","2,444,053","2,411,662","2,370,126","2,354,186","2,344,045","2,331,974","2,298,821","2,272,925","2,252,462","2,231,964","2,231,051","2,210,164","2,208,938","2,194,235","2,192,476","2,190,233","2,164,557","2,104,817","2,078,620","2,059,176","2,033,769","2,020,005","1,974,639","1,944,011","1,906,432","1,906,158","1,850,249","1,847,178","1,847,083","1,824,355","1,805,497","1,785,297","1,775,327","1,729,007","1,715,869","1,687,412","1,674,921","1,649,317","1,641,656"],["872,197","212,804","67,616","1,095,912","2,335,834","243,594","12,695","48,491","139,928","7,105","541,752","30,586","7,684","127,633","508,576","162,526","25,068","26,757","285,839","144,978","104,094","29,357","125,119","27,759","26,449","7,891","2,936,514","360,358","18,282","95,250","124,743","60,643","2,868","110,678","103,041","185,327","53,372","50,791","5,232","80,626","77,363","59,963","52,935","88,301","42,409","189,473","286","89,184","51,202","70,267","192,445","13,256","60,250","1,779","51,320","389","33,007","44,479","10,992","9,256","12,822","24,255","14,923","39,343","180,239","18,481","83,170","14,864","158","17,632","29,623","9,188","68,401","60,096","4,038","175,539","248,175","125,239","45,078","50,826","27,066","38,433","38,575","2,840","34,705","10,613","31,528","17,329","237,302","16,269","50,948","6,490","102,238","231,077","25,122","16,185","14,419","42,555","21,726","5,657"],["706","2,585","1,778","43,595","100,500","11,410","747","2,985","13,130","723","57,655","3,510","877","15,315","62,200","23,900","3,690","4,015","46,250","24,900","18,820","5,640","24,410","5,615","5,380","1,655","606,000","79,600","4,035","21,070","27,495","13,615","697","27,000","25,770","47,250","13,615","12,720","1,351","22,350","22,000","17,030","15,930","26,200","12,750","57,670","86","27,860","15,845","21,935","61,800","4,405","21,260","640","19,590","149","12,770","17,490","4,375","3,785","5,310","10,020","6,050","16,720","77,000","7,880","35,910","6,320","69","7,815","13,150","4,015","30,995","27,050","1,850","78,800","117,000","58,815","21,900","24,480","13,125","19,045","19,315","1,467","18,040","5,685","16,475","9,465","129,600","8,810","28,120","3,060","58,400","129,000","14,615","9,490","8,535","25,575","13,270","3,495"],["707","2,590","1,779","43,600","100,600","11,415","748","2,990","0","724","57,660","3,515","878","15,320","62,300","23,950","3,695","4,020","46,300","24,950","18,825","5,650","24,415","5,620","5,400","1,656","607,000","79,700","4,040","21,075","27,500","13,620","698","27,050","25,775","47,300","13,620","12,725","1,354","22,355","22,050","17,040","15,935","26,250","12,755","57,675","87","27,865","15,850","21,940","61,900","4,410","21,265","644","19,605","150","12,775","17,495","4,380","3,790","5,320","10,025","6,060","16,725","77,100","7,885","35,915","6,330","70","7,820","13,155","4,020","31,000","27,100","1,851","79,000","117,100","58,820","21,950","24,485","13,130","19,050","19,320","1,468","18,050","5,690","16,480","9,470","129,700","8,820","28,125","3,065","58,500","129,100","14,640","9,495","8,545","25,600","13,275","3,500"],["15,579","7,827","5,442","37,605","5,955,156","16,487","613","2,552","8,243","784","106,287","3,692","2,093","12,425","275,564","136,306","1,478","321","296,908","46,519","17,893","1,921","110,699","7,174","15,512","1,461","4,411,694","509,887","3,029","17,667","28,655","14,083","3,299","238,040","9,537","23,374","2,901","3,391","520","62,862","19,865","6,646","16,031","192,328","5,355","42,535","1,287","3,400","4,793","12,308","26,886","29,899","7,398","2,091","13,987","585","4,278","2,747","9,143","3,671","11,414","5,411","2,353","2,877","629,116","13,196","19,394","4,024","443","22,342","18,031","402","40,455","8,558","5,971","382,570","85,962","14,970","78,218","40,290","7,990","14,135","7,747","1,381","10,827","1,993","2,686","748","397,112","9,449","7,775","403","72,467","492,086","4,386","11,844","8,825","1,549","5,556","1,748"],["N/A","N/A","N/A","N/A","22.47","N/A","N/A","N/A","-198.94","-2.38","N/A","N/A","-2.51","N/A","129.52","14.41","N/A","N/A","4.69","159.94","N/A","27.16","N/A","N/A","5.97","N/A","15.29","-476.65","22.57","N/A","N/A","N/A","-24.07","84.01","N/A","293.79","N/A","N/A","-37.61","N/A","58.36","N/A","N/A","6.75","N/A","N/A","N/A","N/A","N/A","N/A","12.11","-7.10","N/A","-3.46","N/A","-18.75","N/A","N/A","N/A","6.94","24.29","N/A","21.92","N/A","17.22","N/A","N/A","37.40","N/A","N/A","N/A","N/A","N/A","-307.39","3.92","8.38","76.14","N/A","10.42","N/A","N/A","N/A","N/A","1.36","52.29","N/A","N/A","N/A","45.71","-9.79","N/A","-39.74","7.68","8.84","N/A","N/A","N/A","N/A","N/A","N/A"],["N/A","N/A","N/A","N/A","9.03","N/A","N/A","N/A","-5.62","-22.81","N/A","N/A","-9.94","N/A","0.56","7.94","N/A","N/A","9.22","5.85","N/A","11.52","N/A","N/A","21.77","N/A","31.06","1.52","6.35","N/A","N/A","N/A","-13.91","1.77","N/A","2.73","N/A","N/A","-1.56","N/A","1.56","N/A","N/A","9.39","N/A","N/A","N/A","N/A","N/A","N/A","12.44","-13.90","N/A","-37.91","N/A","-12.02","N/A","N/A","N/A","4.81","2.37","N/A","10.04","N/A","N/A","N/A","N/A","0.73","N/A","N/A","N/A","N/A","N/A","-2.77","8.93","8.11","24.92","N/A","8.73","N/A","N/A","N/A","N/A","-15.36","7.59","N/A","N/A","N/A","11.52","-21.71","N/A","6.54","10.79","8.86","N/A","N/A","N/A","N/A","N/A","N/A"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>N<\/th>\n      <th>종목명<\/th>\n      <th>현재가<\/th>\n      <th>전일비<\/th>\n      <th>등락률<\/th>\n      <th>거래량<\/th>\n      <th>거래대금<\/th>\n      <th>매수호가<\/th>\n      <th>매도호가<\/th>\n      <th>시가총액<\/th>\n      <th>PER<\/th>\n      <th>ROE<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":1},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"N","targets":1},{"name":"종목명","targets":2},{"name":"현재가","targets":3},{"name":"전일비","targets":4},{"name":"등락률","targets":5},{"name":"거래량","targets":6},{"name":"거래대금","targets":7},{"name":"매수호가","targets":8},{"name":"매도호가","targets":9},{"name":"시가총액","targets":10},{"name":"PER","targets":11},{"name":"ROE","targets":12}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
</div>
</div>
</section></section><section id="api의-활용" class="level2" data-number="3"><h2 data-number="3" class="anchored" data-anchor-id="api의-활용">
<span class="header-section-number">3</span> API의 활용</h2>
<p>KOSIS를 포함한 많은 대한민국의 데이터 포털은 개방 API 서비스를 제공하고 있다. KOSIS는 공유서비스 홈페이지(<a href="https://kosis.kr/openapi/index.jsp">https://kosis.kr/openapi/</a>)를 통해 Open API를 통한 데이터 수집을 권장하고 있다.</p>
<p>앞에서 설명한 것처럼, API용 패키지를 직접 사용할 수도 있지만, 래퍼 패키지가 존재하기만 한다면 그것을 활용하는 것이 훨씬 손쉬운 옵션일 수 있다. 놀랍게도 한국의 주석훈(Seokhoon Joo)이라는 분이 그러한 기능을 하는 <code>kosis</code>(<a href="https://cran.r-project.org/web/packages/kosis/">https://cran.r-project.org/web/packages/kosis/index.html</a>)라는 패키지를 이미 개발해 두었고, 그것을 활용하고자 한다.</p>
<p>실습 주제는 2024년 센서스 인구 기준으로 전국의 17개 시도별 ’지방소멸위험지수’를 계산하고 그래프의 형태로 표현하는 것이다.</p>
<section id="kosis에서-api-key-받기" class="level3" data-number="3.1"><h3 data-number="3.1" class="anchored" data-anchor-id="kosis에서-api-key-받기">
<span class="header-section-number">3.1</span> KOSIS에서 API KEY 받기</h3>
<p>먼저 API를 활용하기 위해 기관으로부터 KEY를 발급받아야 한다. 이를 위해 통계청에 회원가입을 한 후, KEY를 요청해야 한다. 과정은 아래와 같다.</p>
<ul>
<li><p>KOSIS 공유서비스 웹페이지(<a href="https://kosis.kr/openapi/" class="uri">https://kosis.kr/openapi/</a>) 접속</p></li>
<li>
<p>상단의 [활용신청] 탭 클릭</p>
<ul>
<li>통계청의 ONE-ID로 통합로그인(없으면 회원가입 필수)</li>
</ul>
</li>
<li>
<p>활용신청하여 사용자 인증키 획득</p>
<ul>
<li>사용자 인증키는 마이페이지에서 언제든 확인 가능</li>
</ul>
</li>
</ul></section><section id="패키지-설치-및-인증키-등록" class="level3" data-number="3.2"><h3 data-number="3.2" class="anchored" data-anchor-id="패키지-설치-및-인증키-등록">
<span class="header-section-number">3.2</span> 패키지 설치 및 인증키 등록</h3>
<p>우선&nbsp;<code>kosis</code>&nbsp;패키지를 오른쪽 하단 윈도우의 Packages 탭을 활용하여 인스톨한다. 이후에 아래와 같이&nbsp;<code>kosis</code>와&nbsp;<code>tidyverse</code>&nbsp;패키지를 불러온다.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">kosis</span><span class="op">)</span></span></code></pre></div><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>다음으로, <code>kosis</code> 패키지의&nbsp;<a href="https://rdrr.io/pkg/kosis/man/kosis.setKey.html"><code>kosis.setKey()</code></a>&nbsp;함수를 이용하여 인증키를 등록한다. Your Key Here 자리에 부여받은 인증키를 붙여 넣는다.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/kosis/man/kosis.setKey.html">kosis.setKey</a></span><span class="op">(</span>apiKey <span class="op">=</span> <span class="st">"Your Key Here"</span><span class="op">)</span></span></code></pre></div><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section><section id="데이터-추출" class="level3" data-number="3.3"><h3 data-number="3.3" class="anchored" data-anchor-id="데이터-추출">
<span class="header-section-number">3.3</span> 데이터 추출</h3>
<p>이제 통계청 홈페이지에 접속해서 데이터를 불러와본다. 과정은 아래와 같다.</p>
<ul>
<li><p>KOSIS에 접속 후 로그인</p></li>
<li>
<p>데이터에 접근 후 URL 생성</p>
<ul>
<li><p>[국내통계]-[주제별 통계]-[인구]-[인구총조사]-[인구부문]-[총조사인구(2015년 이후)]-[전수부문 (등록센서스, 2015년 이후)]-[전수기본표]-[연령 및 성별 인구]</p></li>
<li><p><strong>항목</strong>: ‘총인구(명)’, ‘총인구_남자(명)’, ’총인구_여자(명)’만 선택(더 많은 항목을 선택하면 데이터가 너무 커 에러가 발생)</p></li>
<li><p><strong>행정구역별(읍면동)</strong>: ‘1 레벨’과 ’2 레벨’ 선택(’1 레벨’은 시도 수준, ’2 레벨’은 시군구 수준)</p></li>
<li><p><strong>조회기간</strong>: ‘기간설정’ 버튼을 누른 후, 기간설정이 2024~2024년인지 확인한다.</p></li>
<li><p><strong>응답필드</strong>: 하나씩 눌러 모두 선택한 후, ‘URL생성’ 탭을 클릭한다. 그리고 나서 ‘URL 복사’ 탭을 클릭한다. URL 속에 api key가 포함되어 있음을 확인한다.</p></li>
</ul>
</li>
<li><p>생성한 URL로부터 데이터 획득</p></li>
</ul>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">your_url</span> <span class="op">&lt;-</span> <span class="st">"Your URL"</span></span>
<span><span class="va">data_api</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/kosis/man/getStatDataFromURL.html">getStatDataFromURL</a></span><span class="op">(</span>url <span class="op">=</span> <span class="va">your_url</span><span class="op">)</span></span></code></pre></div><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><code>getStatDataFromURL</code> 함수의 아규먼트에 위에서 생성한 URL을 입력하면, 다운로드 과정 없이 곧바로 데이터를 획득할 수 있다.</p>
</section><section id="데이터-정리-및-변형" class="level3" data-number="3.4"><h3 data-number="3.4" class="anchored" data-anchor-id="데이터-정리-및-변형">
<span class="header-section-number">3.4</span> 데이터 정리 및 변형</h3>
<p>아래와 같이 데이터를 정리 및 변형한다. 최종적으로 지역별 지역소멸위험지수를 산출한다.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data_api</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">C1</span>, <span class="va">C1_NM</span>, <span class="va">C2_NM</span>, <span class="va">ITM_ID</span>, <span class="va">DT</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co"># C1: 행정구역 코드 / C1_NM: 행정구역 이름 </span></span>
<span>  <span class="co"># C2: 연령 코드 / C2_NM: 연령대</span></span>
<span>  <span class="co"># ITM_ID: 성별 코드 / DT: 인구 수</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    DT <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/na_if.html">na_if</a></span><span class="op">(</span><span class="va">DT</span>, <span class="st">"X"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">C1</span>, <span class="va">DT</span><span class="op">)</span>, <span class="va">as.numeric</span><span class="op">)</span>,</span>
<span>    ITM_ID <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_match.html">case_match</a></span><span class="op">(</span></span>
<span>    <span class="va">ITM_ID</span>,</span>
<span>    <span class="st">"T00"</span> <span class="op">~</span> <span class="st">"T"</span>,</span>
<span>    <span class="st">"T01"</span> <span class="op">~</span> <span class="st">"M"</span>,</span>
<span>    <span class="st">"T02"</span> <span class="op">~</span> <span class="st">"F"</span><span class="op">)</span>,</span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unite.html">unite</a></span><span class="op">(</span><span class="st">"gender_age"</span>, <span class="va">ITM_ID</span>, <span class="va">C2_NM</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span></span>
<span>    id_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">C1</span>, <span class="va">C1_NM</span><span class="op">)</span>,</span>
<span>    names_from <span class="op">=</span> <span class="va">gender_age</span>,</span>
<span>    values_from <span class="op">=</span> <span class="va">DT</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    index <span class="op">=</span> <span class="op">(</span><span class="va">`F_20~24세`</span> <span class="op">+</span> <span class="va">`F_25~29세`</span> <span class="op">+</span> <span class="va">`F_30~34세`</span> <span class="op">+</span> <span class="va">`F_35~39세`</span><span class="op">)</span> <span class="op">/</span> <span class="va">`T_65세이상`</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span></span>
<span>    <span class="va">C1</span>, <span class="va">C1_NM</span>, <span class="va">index</span></span>
<span>  <span class="op">)</span></span></code></pre></div><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="결측치 처리 함수">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">노트</span>결측치 처리 함수
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><a href="https://dplyr.tidyverse.org/reference/na_if.html"><code>na_if()</code></a> 함수는 두 개의 인수를 받는데, 첫번째는 벡터(혹은 열), 두번째는 특정 값이다. 두 값을 받아 해당 열의 특정 값을 결측치로 바꾸는 역할을 한다. 여기서는 <code>DT</code> 열에 포함된 ’X’라는 값을 결측치로 바꿔 분석에서 제외했다. 반대로, <a href="https://tidyr.tidyverse.org/reference/replace_na.html"><code>replace_na()</code></a>라는 함수는 이미 NA(결측치)로 되어 있는 값을 다른 값으로 채울 때 사용된다.</p>
</div>
</div>
</div>
<p>시도 데이터와 시군구 데이터를 분리하여 저장한다.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data_sido</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html">nchar</a></span><span class="op">(</span><span class="va">C1</span><span class="op">)</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">data_sgg</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html">nchar</a></span><span class="op">(</span><span class="va">C1</span><span class="op">)</span> <span class="op">==</span> <span class="fl">5</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">C1</span>, <span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="op">!</span><span class="va">C1_NM</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"동부"</span>, <span class="st">"면부"</span>, <span class="st">"읍부"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section><section id="그래프-작성" class="level3" data-number="3.5"><h3 data-number="3.5" class="anchored" data-anchor-id="그래프-작성">
<span class="header-section-number">3.5</span> 그래프 작성</h3>
<p>인구소멸위험지수 연구에서 주로 사용되는 5개의 위험도 클래스의 구분법을 적용하고, 위험도 클래스별로 특정한 색상을 적용하고, 그래프의 범례에 5개의 클래스가 모두 나타나게 하려다보니 코드가 조금 복잡해졌다.&nbsp;</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">data_sido</span> <span class="op">&lt;-</span> <span class="va">data_sido</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    index_class <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">index</span> <span class="op">&lt;</span> <span class="fl">0.2</span> <span class="op">~</span> <span class="st">"1"</span>,</span>
<span>      <span class="va">index</span> <span class="op">&gt;=</span> <span class="fl">0.2</span> <span class="op">&amp;</span> <span class="va">index</span> <span class="op">&lt;</span> <span class="fl">0.5</span> <span class="op">~</span> <span class="st">"2"</span>,</span>
<span>      <span class="va">index</span> <span class="op">&gt;=</span> <span class="fl">0.5</span> <span class="op">&amp;</span> <span class="va">index</span> <span class="op">&lt;</span> <span class="fl">1.0</span> <span class="op">~</span> <span class="st">"3"</span>,</span>
<span>      <span class="va">index</span> <span class="op">&gt;=</span> <span class="fl">1.0</span> <span class="op">&amp;</span> <span class="va">index</span> <span class="op">&lt;</span> <span class="fl">1.5</span> <span class="op">~</span> <span class="st">"4"</span>,</span>
<span>      <span class="va">index</span> <span class="op">&gt;=</span> <span class="fl">1.5</span> <span class="op">~</span> <span class="st">"5"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    index_class <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">index_class</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">class_color</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1"</span> <span class="op">=</span> <span class="st">"#d7191c"</span>, <span class="st">"2"</span> <span class="op">=</span> <span class="st">"#fdae61"</span>,</span>
<span>                 <span class="st">"3"</span> <span class="op">=</span> <span class="st">"#ffffbf"</span>, <span class="st">"4"</span> <span class="op">=</span> <span class="st">"#a6d96a"</span>, </span>
<span>                 <span class="st">"5"</span> <span class="op">=</span> <span class="st">"#1a9641"</span><span class="op">)</span></span>
<span><span class="va">data_sido</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">index</span>, y <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_reorder.html">fct_reorder</a></span><span class="op">(</span><span class="va">C1_NM</span>, <span class="va">index</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">index_class</span><span class="op">)</span>, show.legend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">index</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>, </span>
<span>                               nsmall <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span>, hjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Classes"</span>, </span>
<span>                    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"&lt; 0.2"</span>, <span class="st">"0.2 ~ 0.5"</span>, <span class="st">"0.5 ~ 1.0"</span>, </span>
<span>                               <span class="st">"1.0 ~ 1.5"</span>, <span class="st">"&gt;= 1.5"</span><span class="op">)</span>, </span>
<span>                    values <span class="op">=</span> <span class="va">class_color</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"인구소멸위험지수, 2024년"</span>, </span>
<span>       x <span class="op">=</span> <span class="st">"인구소멸위험지수"</span>, </span>
<span>       y <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code></pre></div><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="lab_08_2025_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">힌트</span>KOSIS API의 추가 예제
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>이렇게 KOSIS 홈페이지에서 URL을 직접 지정하지 않고도 데이터를 불러오는 방법이 있다. <code>getStatData</code> 함수로, 기관명과 데이터 코드를 아규먼트에 입력하면 해당 데이터를 불러올 수 있다. 가령 방금 실습에서 사용한 데이터는 통계청의 2015년 인구총조사 전수부문의 연령 및 성별인구에 해당한다. 이때 통계청의 기관 코드는 <u><strong>101</strong></u>, 해당 데이터의 코드는 <u><strong>DT_1IN503</strong></u>이다.</p>
<p>아래의 코드는 여기에 몇 개의 아규먼트를 더 추가하여 서울특별시 종로구의 2015년부터 2022년까지의 데이터를 불러오고, 이를 바탕으로 인구소멸지수를 계산하여 그 추이를 시각화 한 것이다.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">aoi_code</span> <span class="op">&lt;-</span> <span class="st">"11010"</span> <span class="co"># 서울특별시 종로구 코드</span></span>
<span><span class="va">aoi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/kosis/man/getStatData.html">getStatData</a></span><span class="op">(</span>orgId <span class="op">=</span> <span class="fl">101</span>, tblId <span class="op">=</span> <span class="st">"DT_1IN1503"</span>, prdSe <span class="op">=</span> <span class="st">"Y"</span>,</span>
<span>                    startPrdDe <span class="op">=</span> <span class="st">"2015"</span>, endPrdDe <span class="op">=</span> <span class="st">"2024"</span>,</span>
<span>                    objL1 <span class="op">=</span> <span class="va">aoi_code</span>, objL2 <span class="op">=</span> <span class="st">"ALL"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html">nchar</a></span><span class="op">(</span><span class="va">C2</span><span class="op">)</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">aoi</span> <span class="op">&lt;-</span> <span class="va">aoi</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">C1</span>, <span class="va">C1_NM</span>, <span class="va">C2</span>, <span class="va">C2_NM</span>, <span class="va">ITM_ID</span>, <span class="va">ITM_NM</span>, <span class="va">DT</span>, <span class="va">PRD_DE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">ITM_ID</span> <span class="op">==</span> <span class="st">"T00"</span> <span class="op">|</span> <span class="va">ITM_ID</span> <span class="op">==</span> <span class="st">"T01"</span> <span class="op">|</span> <span class="va">ITM_ID</span> <span class="op">==</span> <span class="st">"T02"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    DT <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/na_if.html">na_if</a></span><span class="op">(</span><span class="va">DT</span>, <span class="st">"X"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">C1</span>, <span class="va">DT</span><span class="op">)</span>, <span class="va">as.numeric</span><span class="op">)</span>,</span>
<span>    ITM_ID <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_match.html">case_match</a></span><span class="op">(</span></span>
<span>      <span class="va">ITM_ID</span>, <span class="st">"T00"</span> <span class="op">~</span> <span class="st">"T"</span>,</span>
<span>      <span class="st">"T01"</span> <span class="op">~</span> <span class="st">"M"</span>,</span>
<span>      <span class="st">"T02"</span> <span class="op">~</span> <span class="st">"F"</span><span class="op">)</span>,</span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unite.html">unite</a></span><span class="op">(</span><span class="st">"gender_age"</span>, <span class="va">ITM_ID</span>, <span class="va">C2_NM</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span></span>
<span>    id_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">C1</span>, <span class="va">C1_NM</span>, <span class="va">PRD_DE</span><span class="op">)</span>,</span>
<span>    names_from <span class="op">=</span> <span class="va">gender_age</span>,</span>
<span>    values_from <span class="op">=</span> <span class="va">DT</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    index <span class="op">=</span> <span class="op">(</span><span class="va">`F_20~24세`</span> <span class="op">+</span> <span class="va">`F_25~29세`</span> <span class="op">+</span> <span class="va">`F_30~34세`</span> <span class="op">+</span> <span class="va">`F_35~39세`</span><span class="op">)</span> <span class="op">/</span> <span class="va">`T_65세이상`</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span></span>
<span>    <span class="va">C1</span>, <span class="va">C1_NM</span>, <span class="va">index</span>, <span class="va">PRD_DE</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">region</span> <span class="op">&lt;-</span> <span class="va">aoi</span><span class="op">$</span><span class="va">C1_NM</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre></div><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">aoi</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">PRD_DE</span>, y<span class="op">=</span><span class="va">index</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>group <span class="op">=</span> <span class="fl">1</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">region</span>, <span class="st">" 인구소멸위험지수 추이"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"연도"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"인구소멸위험지수"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">18</span>, hjust<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="lab_08_2025_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><code>aoi_code</code>에 내가 원하는 지역의 코드를 넣으면 마찬가지로 해당 관심지역의 인구소멸위험지수 추이를 관측할 수 있다. 예컨대 인구가 빠르게 증가하는 경기 김포시는 “31230”, 화성시는 “31240”이고, 소멸지수가 가장 높은 경북 상주시는 “37080”, 경북 문경시는 “37090”이다. 제공한 코드에서 한번 <code>aoi_code</code> 부분만 변경해보자.</p>
<p>한편, 이렇게 URL 없이 데이터를 불러오는 경우 KOSIS에서 직접 조정하는 것에 비해 덜 번거롭지만 제한사항도 많다. 가령 복수의 지역을 불러오는 것이 반복문을 사용하지 않고서는 불가능하고, 불필요한 데이터를 빼고 가져오기도 어렵다. 그러나 startPrdDe와 endPrdDe 아규먼트를 이용해 데이터를 시계열로 수집하고자 하는 측면에서는 유용하다.</p>
<p>그러므로 수집하고자 하는 데이터를 잘 파악해서 API를 활용해보자.</p>
</div>
</div>
</div>
</section><section id="cf-kosis-api를-활용한-함수-작성" class="level3" data-number="3.6"><h3 data-number="3.6" class="anchored" data-anchor-id="cf-kosis-api를-활용한-함수-작성">
<span class="header-section-number">3.6</span> cf) KOSIS API를 활용한 함수 작성</h3>
<p>마지막으로, API를 활용한 함수를 소개한다. API를 신청할 때 보았듯, 이는 웹/앱 애플리케이션을 제작하기 위한 용도로 주로 사용된다.</p>
<p>이와 관련된 매우 간단한 예시로, 학생에게 인구소멸지수가 궁금한 지역을 검색해보도록 하는 활동을 구상한다고 가정해보자. 학생이 매번 코드를 작성하며 확인하기란 사실상 불가능하다. 그런데 위에서 사용한 코드와 API를 활용하면 함수를 어렵지 않게 생성할 수 있다.</p>
<p>예컨대 교사가 아래와 같이 <code>exInd()</code> 함수를 한번 작성해두면, 학생은 단 한 줄의 코드만 입력해도 금방 지역의 인구소멸지수의 추이를 탐색해볼 수 있을 것이다.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 함수 생성: 교사 작성 부분</span></span>
<span><span class="va">exInd</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co"># Library</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">kosis</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/DT">DT</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ycphs.github.io/openxlsx/index.html">openxlsx</a></span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Table for Searching Region Code</span></span>
<span>  <span class="va">region_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/read.xlsx.html">read.xlsx</a></span><span class="op">(</span><span class="st">"https://github.com/Sechang-Kim/gis-lab/raw/download/korea-sigungu-code(2022).xlsx"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html">datatable</a></span><span class="op">(</span><span class="va">region_table</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Input Arguments</span></span>
<span>  <span class="va">aoi_code</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readline.html">readline</a></span><span class="op">(</span><span class="st">'지역 코드를 입력하세요: '</span><span class="op">)</span></span>
<span>  <span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/readline.html">readline</a></span><span class="op">(</span><span class="st">'시작 연도를 입력하세요: '</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">end</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/readline.html">readline</a></span><span class="op">(</span><span class="st">'종료 연도를 입력하세요: '</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Data Request</span></span>
<span>  <span class="va">aoi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/kosis/man/getStatData.html">getStatData</a></span><span class="op">(</span>orgId <span class="op">=</span> <span class="fl">101</span>, tblId <span class="op">=</span> <span class="st">"DT_1IN1503"</span>, prdSe <span class="op">=</span> <span class="st">"Y"</span>,</span>
<span>                     startPrdDe <span class="op">=</span> <span class="va">start</span>, endPrdDe <span class="op">=</span> <span class="va">end</span>,</span>
<span>                     objL1 <span class="op">=</span> <span class="va">aoi_code</span>, objL2 <span class="op">=</span> <span class="st">"ALL"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html">nchar</a></span><span class="op">(</span><span class="va">C2</span><span class="op">)</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span> <span class="co"># Delete 1-age interval(Only 5-age interval)</span></span>
<span>  </span>
<span>  <span class="co"># Data Cleansing</span></span>
<span>  <span class="va">aoi</span> <span class="op">&lt;-</span> <span class="va">aoi</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">C1</span>, <span class="va">C1_NM</span>, <span class="va">C2</span>, <span class="va">C2_NM</span>, <span class="va">ITM_ID</span>, <span class="va">ITM_NM</span>, <span class="va">DT</span>, <span class="va">PRD_DE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">ITM_ID</span> <span class="op">==</span> <span class="st">"T00"</span> <span class="op">|</span> <span class="va">ITM_ID</span> <span class="op">==</span> <span class="st">"T01"</span> <span class="op">|</span> <span class="va">ITM_ID</span> <span class="op">==</span> <span class="st">"T02"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>      DT <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/na_if.html">na_if</a></span><span class="op">(</span><span class="va">DT</span>, <span class="st">"X"</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">C1</span>, <span class="va">DT</span><span class="op">)</span>, <span class="va">as.numeric</span><span class="op">)</span>,</span>
<span>      ITM_ID <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_match.html">case_match</a></span><span class="op">(</span></span>
<span>        <span class="va">ITM_ID</span>, <span class="st">"T00"</span> <span class="op">~</span> <span class="st">"T"</span>,</span>
<span>        <span class="st">"T01"</span> <span class="op">~</span> <span class="st">"M"</span>,</span>
<span>        <span class="st">"T02"</span> <span class="op">~</span> <span class="st">"F"</span><span class="op">)</span>,</span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unite.html">unite</a></span><span class="op">(</span><span class="st">"gender_age"</span>, <span class="va">ITM_ID</span>, <span class="va">C2_NM</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span></span>
<span>      id_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">C1</span>, <span class="va">C1_NM</span>, <span class="va">PRD_DE</span><span class="op">)</span>,</span>
<span>      names_from <span class="op">=</span> <span class="va">gender_age</span>,</span>
<span>      values_from <span class="op">=</span> <span class="va">DT</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>      index <span class="op">=</span> <span class="op">(</span><span class="va">`F_20~24세`</span> <span class="op">+</span> <span class="va">`F_25~29세`</span> <span class="op">+</span> <span class="va">`F_30~34세`</span> <span class="op">+</span> <span class="va">`F_35~39세`</span><span class="op">)</span> <span class="op">/</span> <span class="va">`T_65세이상`</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span></span>
<span>      <span class="va">C1</span>, <span class="va">C1_NM</span>, <span class="va">index</span>, <span class="va">PRD_DE</span></span>
<span>    <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">## Visualization</span></span>
<span>  <span class="va">region</span> <span class="op">&lt;-</span> <span class="va">aoi</span><span class="op">$</span><span class="va">C1_NM</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="co"># For Auto-Plot Title</span></span>
<span>  <span class="va">vis</span> <span class="op">&lt;-</span> <span class="va">aoi</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">PRD_DE</span>, y<span class="op">=</span><span class="va">index</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>group <span class="op">=</span> <span class="fl">1</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">region</span>, <span class="st">" 인구소멸위험지수 추이"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"연도"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"인구소멸위험지수"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">18</span>, hjust<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">vis</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># 함수 실행: 학생 작성 부분</span></span>
<span><span class="fu">exInd</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></div>
</div>


</section></section><a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> 맨 위로</a></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "복사완료!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "복사완료!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./lab_07_2025.html" class="pagination-link" aria-label="데이터 사이언스의 과정 복습하기">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">데이터 사이언스의 과정 복습하기</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./lab_09_2025.html" class="pagination-link" aria-label="소통하기: 인터랙티브 시각화">
        <span class="nav-page-text">소통하기: 인터랙티브 시각화</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2024, Sang-Il Lee</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/sangillee66/data_science/issues/new" class="toc-action"><i class="bi bi-github"></i>이슈 보고</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item compact">
    <a class="nav-link" href="https://sangillee.snu.ac.kr/">
      <i class="bi bi-house" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:si_lee@snu.ac.kr">
      <i class="bi bi-envelope" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/sangillee66">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
</ul>
</div>
  </div>
</footer>


</body></html>