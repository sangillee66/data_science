---
title: |
  | [R Lecture 6]{style="color:coral;font-size:0.6em"}   
  | [데이터 시각화하기]{style="font-size:1em"} 
author: <br> 이상일(서울대학교 지리교육과 교수)
date: 2025-10-21
format: 
  revealjs:
    logo: snu_edu_1.png
    footer: https://sangillee.snu.ac.kr/
    transition: fade
    transition-speed: fast
    margin: 0.05
    center: false
    # smaller: false
    # scrollable: false
    code-link: true
    code-line-numbers: false
    code-copy: true
    code-overflow: scroll
    slide-number: true
    width: 960 * 1.5
    height: 700 * 1.5
    lightbox: false
    # min-scale: 1
    # max-scale: 1
    pointer:
      pointerSize: 20
      color: red
    menu: true
    embed-resources: false
    theme: [default, custom_hq_pretendard_step.scss] # 슬라이드 본문 폰트 크기 조정
    revealjs-plugins:
      - pointer
    css: styles.css
execute: 
  warning: false
  error: false
  freeze: auto  
dpi: 600
editor: visual
webr: 
  show-startup-message: false     
  packages: []
filters:
  - webr
# suppress-bibliography: true
editor_options: 
  chunk_output_type: console
---

# [기본 개념]{style="color:coral"}

## 데이터사이언스 프로세스

![](images/clipboard-1040421420.png)

## 데이터사이언스 프로세스: 타이디버스

![[https://r4ds.hadley.nz/intro.html](https://r4ds.hadley.nz/intro.html){style="font-size:1.25rem"}](images/data_science_process_packages-04.png)

## **ggplot2** 패키지

![[https://ggplot2.tidyverse.org/](https://ggplot2.tidyverse.org/){style="font-size:1.25rem"}](images/hex_ggplot2.png){fig-align="center"}

## **ggplot2** 패키지

![[https://allisonhorst.com/r-packages-functions](https://allisonhorst.com/r-packages-functions){style="font-size:1.25rem"}](https://sangillee.snu.ac.kr/2024_AIEDAP/images/clipboard-1476685333.png)

## **ggplot2** 패키지

![[https://allisonhorst.com/r-packages-functions](https://allisonhorst.com/r-packages-functions){style="font-size:1.25rem"}](https://sangillee.snu.ac.kr/2024_AIEDAP/images/clipboard-4023683763.png)

## GG: Grammar of Graphics

![](images/clipboard-3968277018.png){fig-align="center" height="880px"}

## 

샤를 조제프 미나르의 1812 나폴레옹 러시아 원정도

![[https://en.wikipedia.org/wiki/Charles_Joseph_Minard](https://en.wikipedia.org/wiki/Charles_Joseph_Minard){style="font-size:1.25rem"}](images/clipboard-2830686800.png)

## **ggplot2**의 8대 구성요소

![[https://initiation.doana-r.com/06-ggplot2#1](https://initiation.doana-r.com/06-ggplot2#1){style="font-size:1.25rem"}](https://sangillee.snu.ac.kr/data_science/images/clipboard-3014854163.png){fig-align="center"}

# [핵심 구성요소]{style="color:coral"}

## 시각속성과 기하객체

-   시각속성(aesthetics)

    -   플롯의 외견을 규정

    -   시각속성: 컬러(color), 크기(size), 형태(shape), x-축, y-축 등

    -   시각속성 매핑: 특정한 시각속성을 특정한 변수에 부여하는 과정

    -   `aes(시각속성 = 변수명)` 혹은 `mapping = aes()`

-   기하객체(geometries 또는 geometric objects)

    -   플롯의 전체 구조 혹은 형식을 규정

    -   플롯의 유형: 막대플롯(bar plot), 라인플롯(line plot) 등

    -   `geom_*()`

## 시각속성과 기하객체

::: panel-tabset
## Code 1

```{r}
#| eval: false
#| echo: true
gapminder_2007 <- gapminder |> 
  filter(year == 2007) 
ggplot(data = gapminder_2007, mapping = aes(x = gdpPercap, y = lifeExp)) +
  geom_point(aes(color = continent)) +
  geom_smooth(color = "black")
```

## Code 2

```{r}
#| eval: false
#| echo: true
gapminder |> 
  filter(year == 2007) |> 
  ggplot(aes(x = gdpPercap, y = lifeExp)) +
  geom_point(aes(color = continent)) +
  geom_smooth(color = "black")
```

## Result

```{r}
#| eval: true
#| echo: false
library(tidyverse)
library(gapminder)
gapminder |> 
  filter(year == 2007) |> 
  ggplot(aes(x = gdpPercap, y = lifeExp)) +
  geom_point(aes(color = continent)) +
  geom_smooth(color = "black")
```
:::

## 시각속성의 종류 {.smaller}

| 분류           | 시각속성            | 설명                   | 성격         |
|----------------|---------------------|------------------------|--------------|
| 컬러 관련      | `aes(color = )`     | 점/선의 컬러 지정      | 정성 \> 정량 |
|                | `aes(fill = )`      | 면의 필(컬러) 지정     | 정성 \> 정량 |
|                | `aes(alpha = )`     | 점/선/면의 투명도 지정 | 정성 \< 정량 |
| 차이 표현 관련 | `aes(size = )`      | 점의 크기 지정         | 정량         |
|                | `aes(shape = )`     | 점의 모양 지정         | 정성         |
|                | `aes(linetype = )`  | 선의 유형 지정         | 정성         |
|                | `aes(linewidth = )` | 선의 크기 지정         | 정량         |
| 위치 관련      | `aes(x = )`         | x축 지정               | 정성/정량    |
|                | `aes(y = )`         | y축 지정               | 정성/정량    |
| 그룹화 관련    | `aes(group = )`     | 그룹화 기준 지정       | 정성         |

: {tbl-colwidths="\[20, 25, 40, 15\]"}

## 기하객체의 종류 {.smaller}

+-----------+-----------+--------------------+------------------+
| 구분      | 내용      | 기하객체           | 이름             |
+===========+===========+====================+==================+
| 기본 플롯 | 점        | `geom_point()`     | 점플롯(산점도)   |
+-----------+-----------+--------------------+------------------+
|           | 선        | `geom_line()`      | 선플롯(선그래프) |
+-----------+-----------+--------------------+------------------+
|           | 면        | `geom_area()`      | 면적플롯         |
+-----------+-----------+--------------------+------------------+
|           | 막대      | `geom_bar()`       | 막대플롯         |
+-----------+-----------+--------------------+------------------+
| 통계 플롯 | 분포      | `geom_boxplot()`   | 박스플롯         |
|           |           |                    |                  |
|           |           | `geom_histogram()` | 히스토그램       |
+-----------+-----------+--------------------+------------------+
|           | 추세선    | `geom_smooth()`    | 평활곡선플롯     |
+-----------+-----------+--------------------+------------------+
| 기타      | 텍스트    | `geom_text()`      | 텍스트플롯       |
|           |           |                    |                  |
|           |           | `geom_label()`     | 라벨플롯         |
+-----------+-----------+--------------------+------------------+
|           | 지도 제작 | `geom_sf()`        | sf플롯           |
+-----------+-----------+--------------------+------------------+

: {tbl-colwidths="\[20, 20, 30, 30\]"}

# [기타 구성요소]{style="color:coral"}

## 스케일(scale)

-   시각속성의 구현: `scale_시각속성_*()`

-   축 관련: x, y

    -   `scale_x_continuous()`, `scale_x_discrete()`

-   컬러 관련: color, fill

    -   `scale_color_brewer()`, `scale_fill_brewer()`
    -   `scale_color_manual()`, `scale_fill_manual()`

-   기타

    -   `scale_shape()`, `scale_size()`

    -   `scale_linetype()`, `scale_linewidth()`

## 데이터(data)

-   시각화의 가장 기본적인 요소

-   최상위 함수에서 글로벌 지정: `ggplot(data = 데이터프레임명)`

-   특정한 기하객체 함수에서 로컬 지정: `geom_*(data = 데이터프레임명)`

-   다중 지정 가능: 다양한 기하객체에 개별적으로 로컬 지정

## 패싯(facet)

-   다면생성(faceting)을 통해, 하나의 플롯을 여러 개의 하위 플롯으로 분할

-   두 가지 중요 함수

    -   `facet_wrap()`

    -   `facet_grid()`

## 패싯(facet)

::: panel-tabset
## Normal

```{r}
#| echo: true
gapminder |> 
  filter(year == 2007) |> 
  ggplot(aes(x = log(gdpPercap), y = log(lifeExp))) +
  geom_point(aes(size = pop)) +
  geom_smooth()
```

## Faceting

```{r}
#| echo: true
gapminder |> 
  filter(year == 2007) |> 
  ggplot(aes(x = log(gdpPercap), y = log(lifeExp))) +
  geom_point(aes(size = pop)) +
  geom_smooth() +
  facet_wrap(~continent)
```
:::

## 통계적 변환(statistical transformation)

-   시각화 과정에 통계적 변환을 수반

![[https://r4ds.hadley.nz/layers](https://r4ds.hadley.nz/layers){.uri style="font-size:1.25rem"}](images/clipboard-3826441672.png){fig-align="center"}

## 좌표(coordinates)

-   그래픽 요소들의 위치 결정에 기준이 되는 준거 체계

-   두 가지 중요 함수

    -   `coord_flip()`

    -   `coord_fixed()`

## 테마(theme)

-   그래프의 전체적인 외양(테마)를 수정

    -   8개 테마 제공

-   그래프의 세부 구성 요소를 수정

    -   `theme()` 함수

## 테마(theme)

![[https://r4ds.hadley.nz/communication](https://r4ds.hadley.nz/communication){.uri style="font-size:1.25rem"}](images/clipboard-57653269.png){fig-align="center"}

## 테마(theme)

-   수 많은 옵션 <https://ggplot2.tidyverse.org/reference/theme.html>

![[https://isabella-b.com/blog/ggplot2-theme-elements-reference/](https://isabella-b.com/blog/ggplot2-theme-elements-reference/){style="font-size:1.25rem"}](https://sangillee.snu.ac.kr/data_science/images/ggplot_elements2.png)

# [ggplot2 Extensions]{style="color:coral"}

<https://exts.ggplot2.tidyverse.org/>

## 주요 확장 프로그램

-   [**patchwork**](https://patchwork.data-imaginist.com/)

-   [**gganimate**](https://gganimate.com/)

-   [**ggiraph**](https://davidgohel.github.io/ggiraph/)

-   [**ggpattern**](https://trevorldavis.com/R/ggpattern/dev/)

-   [**geomtextpath**](https://allancameron.github.io/geomtextpath/)

-   [**ggdensity**](https://jamesotto852.github.io/ggdensity/)

-   [**GGally**](https://ggobi.github.io/ggally/)

-   [**ggcorrplot**](https://rpkgs.datanovia.com/ggcorrplot/)

## [patchwork](https://patchwork.data-imaginist.com/) 패키지

![[https://allisonhorst.com/r-packages-functions](https://allisonhorst.com/r-packages-functions){style="font-size:1.25rem"}](https://sangillee.snu.ac.kr/2024_AIEDAP/images/clipboard-2622112002.png)

## [gganimate](https://gganimate.com/) 패키지

![[https://allisonhorst.com/r-packages-functions](https://allisonhorst.com/r-packages-functions){style="font-size:1.25rem"}](https://sangillee.snu.ac.kr/2024_AIEDAP/images/clipboard-105467609.png)
